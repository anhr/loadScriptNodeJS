{"version":3,"file":"loadScript.module.js","sources":["../index.js"],"sourcesContent":["/**\r\n * node.js version of the TreeElement\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//load JavaScript file\r\n//http://javascript.ru/forum/events/21439-dinamicheskaya-zagruzka-skriptov.html\r\n//https://learn.javascript.ru/onload-onerror\r\n//src: URL of an external script file.\r\nfunction src( src ) {\r\n\r\n\tfunction loadScriptBase( callback, appendTo ) {\r\n\r\n\t\tvar script = document.createElement( 'script' );\r\n\t\tscript.setAttribute( \"type\", 'text/javascript' );\r\n\t\tcallback( script );\r\n\t\tappendTo.appendChild( script );\r\n\r\n\t}\r\n\r\n\t//Synchronous load JavaScript file\r\n\t//this.sync = function () { loadScriptBase( function ( script ) { script.innerHTML = getSynchronousResponse( src ); } ); }\r\n\r\n\t//Asynchronous load JavaScript file\r\n\t//options: followed options is available\r\n\t//{\r\n\t//\tonload: The onload event occurs when a script has been loaded.\r\n\t//\tonerror: The onerror event occurs when a� error has been occured.\r\n\t//\tappendTo: The node to which the new script will be append.\r\n\t//}\r\n\tthis.async = function ( options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[0];\r\n\r\n\t\tvar isrc;\r\n\r\n\t\tfunction async( srcAsync ) {\r\n\r\n\t\t\tvar scripts = options.appendTo.querySelectorAll( 'script' );\r\n\t\t\tfor ( var i in scripts ) {\r\n\r\n\t\t\t\tvar child = scripts[i];\r\n\t\t\t\tif ( child.id == srcAsync ) {\r\n\r\n\t\t\t\t\tif ( options.onload !== undefined ) {\r\n\r\n\t\t\t\t\t\t//setTimeout( function () { onload() }, 100 );//���� �� ������� ��� ��������, �� ��� �������� ��������� ��� ������ ������ �� �������� ����������� app.js � ���������� ������ addMedia.js:6 Uncaught ReferenceError: App is not defined\r\n\t\t\t\t\t\toptions.onload();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\t\tscript.setAttribute( \"id\", srcAsync );\r\n\r\n\t\t\t\tif ( script.readyState && !script.onload ) {\r\n\r\n\t\t\t\t\t// IE, Opera\r\n\t\t\t\t\tscript.onreadystatechange = function () {\r\n\r\n\t\t\t\t\t\tif ( script.readyState == \"complete\" ) {\r\n\r\n\t\t\t\t\t\t\t// �� ������ �������� loaded\r\n\t\t\t\t\t\t\tif ( options.onload !== undefined ) options.onload(); // (2)\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( script.readyState == \"loaded\" ) {\r\n\r\n\t\t\t\t\t\t\tsetTimeout( options.onload, 0 ); // (1)\r\n\r\n\t\t\t\t\t\t\t// ������� ����������, ����� �� �������� �� complete\r\n\t\t\t\t\t\t\tthis.onreadystatechange = null;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// Rest\r\n\t\t\t\t\tfunction _onload() {\r\n\r\n\t\t\t\t\t\t//console.log( 'loadScript.onload() ' + this.src );\r\n\t\t\t\t\t\tif ( options.onload !== undefined ) {\r\n\r\n\t\t\t\t\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\t\t\t\t\tisrc++;\r\n\t\t\t\t\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t\t\t\t\t} else options.onload();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tscript.onload = _onload;\r\n\r\n\t\t\t\t\tif ( options.onerror !== undefined )\r\n\t\t\t\t\t\tscript.onerror = options.onerror;\r\n\t\t\t\t\telse script.onerror = function () {\r\n\r\n\t\t\t\t\t\tconsole.error( 'loadScript: \"' + this.src + '\" failed' );\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscript.src = srcAsync;\r\n\r\n\t\t\t}, options.appendTo );\r\n\r\n\t\t}\r\n\r\n\t\tif ( src instanceof Array ) {\r\n\r\n\t\t\tisrc = 0;\r\n\t\t\tasync( src[isrc] );\r\n\t\t\t//\t\t\tsrc.forEach( function ( src ) { async( src ); } );\r\n\r\n\t\t} else async( src );\r\n\r\n\t};\r\n\treturn this;\r\n\r\n}\r\n\r\nexport { src };"],"names":["src","loadScriptBase","callback","appendTo","script","document","createElement","setAttribute","appendChild","async","options","getElementsByTagName","isrc","srcAsync","scripts","querySelectorAll","i","child","id","onload","undefined","readyState","onreadystatechange","_onload","Array","length","onerror","error"],"mappings":";;;;;;;;;;AAgBA,SAASA,GAAT,CAAcA,GAAd,EAAoB;cAEVC,cAAT,CAAyBC,QAAzB,EAAmCC,QAAnC,EAA8C;cAEzCC,SAASC,SAASC,aAAT,CAAwB,QAAxB,CAAb;iBACOC,YAAP,CAAqB,MAArB,EAA6B,iBAA7B;mBACUH,MAAV;mBACSI,WAAT,CAAsBJ,MAAtB;;UAcIK,KAAL,GAAa,UAAWC,OAAX,EAAqB;oBAEvBA,WAAW,EAArB;kBACQP,QAAR,GAAmBO,QAAQP,QAAR,IAAoBE,SAASM,oBAAT,CAA+B,MAA/B,EAAwC,CAAxC,CAAvC;cAEIC,IAAJ;mBAESH,KAAT,CAAgBI,QAAhB,EAA2B;mBAEtBC,UAAUJ,QAAQP,QAAR,CAAiBY,gBAAjB,CAAmC,QAAnC,CAAd;oBACM,IAAIC,CAAV,IAAeF,OAAf,EAAyB;wBAEpBG,QAAQH,QAAQE,CAAR,CAAZ;wBACKC,MAAMC,EAAN,IAAYL,QAAjB,EAA4B;6BAEtBH,QAAQS,MAAR,KAAmBC,SAAxB,EAAoC;sCAG3BD,MAAR;;;;;8BAQa,UAAWf,MAAX,EAAoB;2BAE5BG,YAAP,CAAqB,IAArB,EAA2BM,QAA3B;wBAEKT,OAAOiB,UAAP,IAAqB,CAACjB,OAAOe,MAAlC,EAA2C;gCAGnCG,kBAAP,GAA4B,YAAY;kCAElClB,OAAOiB,UAAP,IAAqB,UAA1B,EAAuC;uCAGjCX,QAAQS,MAAR,KAAmBC,SAAxB,EAAoCV,QAAQS,MAAR,GAHE;;kCAOlCf,OAAOiB,UAAP,IAAqB,QAA1B,EAAqC;8CAExBX,QAAQS,MAApB,EAA4B,CAA5B,EAFoC;wCAK/BG,kBAAL,GAA0B,IAA1B;;0BAdF;qBAHD,MAuBO;kCAGGC,OAAT,GAAmB;kCAGbb,QAAQS,MAAR,KAAmBC,SAAxB,EAAoC;uCAE9BpB,eAAewB,KAAf,IAA0BZ,OAASZ,IAAIyB,MAAJ,GAAa,CAArD,EAA6D;;8CAGrDzB,IAAIY,IAAJ,CAAP;oCAHD,MAKOF,QAAQS,MAAR;;;gCAKFA,MAAP,GAAgBI,OAAhB;6BAEKb,QAAQgB,OAAR,KAAoBN,SAAzB,EACChB,OAAOsB,OAAP,GAAiBhB,QAAQgB,OAAzB,CADD,KAEKtB,OAAOsB,OAAP,GAAiB,YAAY;sCAEzBC,KAAR,CAAe,kBAAkB,KAAK3B,GAAvB,GAA6B,UAA5C;0BAFI;;2BAQCA,GAAP,GAAaa,QAAb;gBAzDD,EA2DGH,QAAQP,QA3DX;;cA+DIH,eAAewB,KAApB,EAA4B;sBAEpB,CAAP;qBACOxB,IAAIY,IAAJ,CAAP;WAHD,MAMOH,MAAOT,GAAP;MA/FR;YAkGO,IAAP;;;;;"}